# PAW Chain Explorer Indexer Configuration
# Example configuration with historical indexing enabled

database:
  host: localhost
  port: 5432
  user: explorer
  password: your_password_here
  database: paw_explorer
  ssl_mode: disable
  max_open_conns: 50
  max_idle_conns: 10
  conn_max_lifetime: 3600s

redis:
  host: localhost
  port: 6379
  password: ""
  db: 0
  pool_size: 10
  min_idle_conns: 5
  cache_ttl: 300s

chain:
  chain_id: paw-1
  rpc_url: http://localhost:26657
  grpc_url: localhost:9090
  ws_url: ws://localhost:26657/websocket
  timeout: 30s
  retry_attempts: 3
  retry_delay: 1s

indexer:
  # Starting block height (0 for genesis)
  start_height: 1

  # Batch size for real-time indexing
  batch_size: 100

  # Number of worker threads
  workers: 4

  # Buffer size for blocks
  block_buffer: 1000

  # Enable/disable different indexing features
  index_blocks: true
  index_transactions: true
  index_events: true
  index_accounts: true
  index_validators: true
  index_dex: true
  index_oracle: true
  index_compute: true

  # Real-time sync interval
  sync_interval: 1s

  # ============================================================================
  # HISTORICAL INDEXING CONFIGURATION
  # ============================================================================

  # Enable historical block indexing (set to true to index existing blocks)
  enable_historical_indexing: true

  # Batch size for historical indexing (blocks per batch)
  # Larger batches = faster indexing but more memory usage
  # Recommended: 50-200 depending on block size and RPC capacity
  historical_batch_size: 100

  # Number of parallel block fetches
  # Higher values = faster but may overwhelm RPC node
  # Recommended: 5-20 depending on RPC node capacity
  parallel_fetches: 10

  # Maximum retry attempts for failed blocks
  max_retries: 3

  # Delay between retries (exponential backoff applied)
  retry_delay: 2s

  # RPC requests per second limit
  # Prevents overwhelming the RPC node
  # Recommended: 5-20 depending on node capacity
  rpc_requests_per_sec: 10

api:
  host: 0.0.0.0
  port: 8080
  enable_graphql: true
  enable_rest: true
  enable_websocket: true
  cors_origins:
    - "*"
  rate_limit: 100
  timeout: 30s

metrics:
  enabled: true
  port: 9090
  path: /metrics

# ============================================================================
# PERFORMANCE TUNING NOTES
# ============================================================================
#
# For FAST indexing (good hardware, dedicated RPC node):
# - historical_batch_size: 200
# - parallel_fetches: 20
# - rpc_requests_per_sec: 20
# - max_open_conns: 100
# Expected: 15,000-25,000 blocks/hour
#
# For BALANCED indexing (moderate hardware, shared RPC):
# - historical_batch_size: 100
# - parallel_fetches: 10
# - rpc_requests_per_sec: 10
# - max_open_conns: 50
# Expected: 8,000-15,000 blocks/hour
#
# For CONSERVATIVE indexing (limited resources, public RPC):
# - historical_batch_size: 50
# - parallel_fetches: 5
# - rpc_requests_per_sec: 5
# - max_open_conns: 25
# Expected: 3,000-8,000 blocks/hour
#
# ============================================================================
# MONITORING
# ============================================================================
#
# Monitor these metrics:
# - explorer_historical_blocks_indexed_total
# - explorer_blocks_per_second
# - explorer_historical_indexing_progress_percent
# - explorer_failed_blocks_total
#
# Check indexing status via API:
# - GET /api/v1/indexing/status
# - GET /api/v1/indexing/statistics
# - GET /api/v1/indexing/failed-blocks
#
# ============================================================================
